---
trigger: always_on
---


# Insight 平台交互设计规范 (IDS) v2.0
**主题：** CKD 科研垂直领域的“零手册”体验

---

## 1. 核心交互模式 (Core Interaction Patterns)

### 1.1 “智能推荐 + 人工确认” (Suggest & Confirm)
系统不做黑盒决策，而是做“透明推荐”。
*   **场景**：数据上传后的变量类型识别。
*   **交互设计**：
    *   系统自动识别 `Gender` 为分类变量，`eGFR` 为连续变量。
    *   **界面表现**：在“数据体检”页，展示一个变量列表。系统推断的类型以高亮 Tag 显示。
    *   **用户动作**：用户只需浏览。如果系统判错（例如将数值型的 `Group` 判为连续），用户点击 Tag 切换类型。
    *   **文案**：“系统已自动识别变量类型。请确认是否有误，这将影响后续统计方法的选择。”

### 1.2 “预防式约束” (Preventative Constraints)
不要等用户点“运行”报错了再提示，要在选择时就告诉他“此路不通”。
*   **场景**：线性回归模型配置。
*   **交互设计**：
    *   当用户选择 `Outcome`（结局变量）时。
    *   **逻辑**：线性回归要求结局必须是连续变量。
    *   **界面表现**：下拉菜单中，所有的“分类变量”（如 `死亡/存活`）呈灰色**不可选**状态。
    *   **即时反馈**：鼠标悬停在灰色的选项上，Tooltip 提示：“线性回归的结局变量必须是连续数值（如血压、eGFR）。若研究二分类结局，请切换至 Logistic 回归。”

### 1.3 “渐进式披露” (Progressive Disclosure)
新手看结论，专家看细节。
*   **场景**：模型结果展示。
*   **交互设计**：
    *   **第一层级（默认可见）**：**智能解读面板 (Interpretation Panel)**。用自然语言说人话：“eGFR 每下降 10 个单位，死亡风险显著增加 15% (P<0.05)。”
    *   **第二层级（默认可见）**：**三线表 (Table)**。展示 HR 值、95% CI。
    *   **第三层级（折叠/Tab）**：**诊断信息**。VIF 值、残差图、PH 假定检验。只有当用户点击“查看模型诊断”时才展开。

---

## 2. 关键功能流交互设计

### 2.1 模块一：数据导入与“体检” (Data Health Check)
**目标**：建立数据信任，清洗脏数据。

*   **步骤 1：拖拽上传**
    *   **反馈**：文件解析进度条 + 有趣的 Loading 文案（“正在扫描 eGFR 数据...”、“正在识别缺失值...”）。
*   **步骤 2：自动体检报告 (Health Report)**
    *   **视觉**：使用红/黄/绿交通灯色系。
    *   **卡片内容**：
        *   🔴 **严重问题**：“发现 `Scr` (血肌酐) 列存在非数值字符（如 'UK'），模型无法计算。” -> **引导按钮**：“去清洗”
        *   🟡 **警告**：“`Albumin` 缺失率超过 20%。” -> **引导按钮**：“智能填补”
        *   🟢 **正常**：“数据量 N=500，满足多因素建模需求。”
*   **步骤 3：一键修复向导**
    *   点击“智能填补”，弹出模态框：“对于连续变量（年龄），建议使用‘均值填补’；对于分类变量，建议使用‘众数填补’。”
    *   用户点击 **[应用建议]**，系统展示修复前后的分布直方图对比（透明叠加），让用户直观看到分布未发生剧烈改变。

### 2.2 模块二：Table 1 基线表 (Baseline Characteristics)
**目标**：一键生成论文第一张表，自动进行假设检验。

*   **零手册引导**：
    *   页面空白状态（Empty State）不是空白，而是一张灰色的三线表骨架屏，中间一个大按钮：“生成 Table 1”。
*   **参数配置**：
    *   **分组变量**：下拉框。
    *   **统计变量**：多选框（支持“全选”）。
*   **即时解释 (On-the-fly Logic)**：
    *   表格生成后，每一行的 P 值旁边有一个微小的 `?` 图标。
    *   **Hover 交互**：悬停显示系统决策逻辑。
        *   *示例*：“此处使用了 **Fisher 精确检验**。因为系统检测到样本量 < 40 且期望频数 < 5，不满足卡方检验条件。”
    *   **价值**：这就是“零手册”，用户在使用中学会了统计学择优规则。

### 2.3 模块三：多因素建模 (Modeling) - 以 CKD 预测为例
**目标**：降低复杂模型的门槛，强调临床意义。

*   **场景**：配置 Cox 回归预测肾衰竭风险。
*   **交互流**：
    1.  **目标设定**：
        *   输入框 Label：“时间变量 (Time)” -> Placeholder: "e.g., FollowUp_Months"
        *   输入框 Label：“结局变量 (Event)” -> Placeholder: "e.g., Dialysis (1=Yes)"
    2.  **变量筛选（VIF 实时预警）**：
        *   当用户同时选中 `eGFR` 和 `Scr`（两者高度相关）放入协变量框时。
        *   **反馈**：输入框下方出现黄色警告条：“⚠️ 检测到多重共线性风险。`eGFR` 是由 `Scr` 计算得来的，建议二者只选其一进入模型。”
    3.  **结果解读**：
        *   **HR 可视化**：不只显示数字。在表格右侧画出 **森林图 (Forest Plot)** 的缩略图。
        *   HR > 1 的点标红（危险因素），HR < 1 的点标绿（保护因素），跨越 1 的线标灰（无意义）。

### 2.4 模块四：临床应用 (Nomogram & Calculator)
**目标**：让静态的模型“动”起来。

*   **交互设计**：
    *   **左侧**：传统的列线图（静态图片，用于发论文）。
    *   **右侧**：交互式计算器（用于临床演示）。
    *   **操作**：
        *   提供滑块（Sliders）让用户调整 `Age`、`eGFR`、`Proteinuria` 的值。
        *   底部的一个大圆环（Gauge Chart）实时转动，显示“5年肾衰竭概率”。
    *   **情感化反馈**：
        *   概率 < 10%：圆环绿色，显示“低风险”。
        *   概率 > 50%：圆环红色，显示“高风险”，并弹出提示：“建议缩短随访间隔”。

---

## 3. 视觉与文案规范 (Micro-copy & Visuals)

### 3.1 颜色语义化
在医学统计中，颜色代表证据等级和风险方向。
*   **显著性红 (Significance Red, #D32F2F)**: 用于 P < 0.05, 危险因素 (HR > 1), 错误信息。
*   **安全绿 (Safety Green, #2E7D32)**: 用于 保护因素 (HR < 1), 校验通过, 推荐操作。
*   **中性蓝 (Tech Blue, #3B71CA)**: 用于 操作按钮, 链接, 选中状态。
*   **解释灰 (Meta Gray, #909399)**: 用于 辅助说明, 统计学原理解释。

### 3.2 术语“翻译”对照表
界面上优先显示临床术语，Tooltip 显示统计术语。

| 界面显示 (UI Label) | 统计学术语 (Statistical Term) | Tooltip 解释 |
| :--- | :--- | :--- |
| **结局变量 (Outcome)** | Dependent Variable (Y) | 您希望预测的结果（如死亡、透析）。 |
| **影响因素 (Predictors)** | Independent Variables (X) / Covariates | 可能影响结局的变量。 |
| **效应值 (Effect Size)** | Coef / OR / HR | 正数/大于1代表促进，负数/小于1代表抑制。 |
| **数据填充** | Imputation | 使用统计学方法补全缺失值。 |
| **数值化** | One-Hot Encoding | 将文字类别转换为计算机可读的数字。 |

---

## 4. 异常处理与帮助 (Zero-Manual Strategy)

### 4.1 空状态 (Empty States)
绝不显示“无数据”。
*   **设计**：插画 + 引导文字 + 行动按钮。
*   *示例*：“您还没有运行任何模型。试着点击左上角的‘新建模型’，探索 eGFR 对预后的影响吧！”

### 4.2 错误边界 (Error Boundaries)
*   如果后端计算崩溃（500 Error）。
*   **反馈**：不要弹出一堆代码。弹出友好对话框：“服务器正在处理大量数据，稍微有点累。请检查您的数据是否存在特殊字符，或联系技术支持。”
*   **行动**：提供“下载错误日志”按钮。

### 4.3 全局“知识胶囊”
*   在页面右上角设置一个“💡 分析思路”悬浮球。
*   点击后，根据当前页面展示 Cheat Sheet。
    *   在 **Table 1** 页：展示“如何选择 T 检验还是卡方？”的决策树图。
    *   在 **PSM** 页：展示“倾向性匹配原理解析”的动图。

---

## 5. 总结：用户心智模型映射

| 用户想... | 传统软件 (SPSS/R) | Insight 平台设计 |
| :--- | :--- | :--- |
| **"我有数据，不知道干不干净"** | 手动跑 `summary()`, 肉眼找 NA | **数据体检报告**，红灯停绿灯行。 |
| **"我要做表1，怎么算 P 值?"** | 手动选 T-test 或 Chi-sq | **自动选择检验方法**，并告诉你"为什么选它"。 |
| **"这模型结果啥意思?"** | 看 Coef 表，自己查书 | **智能解读面板**，直接生成"风险增加 2 倍"的结论。 |
| **"我想发 5 分以上的文章"** | 自己写 R 代码做图 | **一键导出高清 Plotly 图**，符合学术出版标准。 |